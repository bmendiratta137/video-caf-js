<html>
<head>
    <script type="text/javascript" src="agent.js"></script>

    <!-- New Relic Video -->
    <script src="../dist/newrelic-caf.min.js"></script>

    <!-- CAF Receiver SDK -->
    <script src="//www.gstatic.com/cast/sdk/libs/caf_receiver/v3/cast_receiver_framework.js"></script>
</head>
<body>
    <cast-media-player></cast-media-player>
    <script>

        // Capture JS errors
        window.onerror = function (msg, url, line) {
            console.log("Message : " + msg );
            console.log("url : " + url );
            console.log("Line number : " + line );
            newrelic.addPageAction("JSError", {"errMessage": msg, "errUrl": url, "errLine": line})
        }

        cast.framework.CastReceiverContext.getInstance().start();
        cast.framework.CastReceiverContext.getInstance().setLoggerLevel(cast.framework.LoggerLevel.DEBUG);

        console.log("Hello CAF Receiver! rev.005");

        // Set logging level (show all messages)
        nrvideo.Log.level = nrvideo.Log.Levels.ALL;

        // Config New Relic Insights backend
        nrvideo.Core.setBackend(new nrvideo.NRInsightsBackend("1567277", "4SxMEHFjPjZ-M7Do8Tt_M0YaTqwf4dTl"));
        
        // Init CAF Tracker
        nrvideo.Core.addTracker(new nrvideo.CAFTracker());
    </script>
</body>
</html>
